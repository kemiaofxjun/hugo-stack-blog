{{ if .Site.Params.enablePreloadingAnim }}
<div id="loading-box">
    <!-- 页面加载完成之后帷幕拉开的效果 -->
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <!-- 旋转盒子动效 -->
    <div class="spinner-box">
        <div class="configure-border-1">
            <div class="configure-core"></div>
        </div>
        <div class="configure-border-2">
            <div class="configure-core"></div>
        </div>
        <div class="loading-word">加载中...</div>
    </div>
</div>
<!-- 页面加载动画 -->
<script>
    // 确保 jQuery 已加载
    if (typeof $ !== 'function') {
        console.error("jQuery is not loaded. Please ensure jQuery is included in your project.");
    }

    // 使用 window.onload 确保所有资源加载完成后隐藏动画
    window.addEventListener("load", function () {
        const loadingBox = document.getElementById('loading-box');
        if (loadingBox) {
            // 延时一段时间以确保动画有足够的时间展示
            setTimeout(function () {
                loadingBox.classList.add("loaded");
                console.log("Preloader hidden after all resources are loaded.");
            }, 500); // 延时 0.5 秒（可根据需要调整）
        } else {
            console.error("Preloader element not found!");
        }
    });

    // 如果需要显示加载进度，可以添加以下逻辑（可选）
    let loadedResources = 0;
    const totalResources = document.images.length + document.styleSheets.length;

    function checkResourceLoad() {
        loadedResources++;
        const progress = Math.round((loadedResources / totalResources) * 100);
        const loadingWord = document.querySelector('.loading-word');
        if (loadingWord) {
            loadingWord.textContent = `加载中... ${progress}%`;
        }
        if (loadedResources >= totalResources) {
            window.dispatchEvent(new Event('load')); // 手动触发 load 事件
        }
    }

    // 监听图片加载
    document.images.forEach(img => {
        img.addEventListener('load', checkResourceLoad);
        img.addEventListener('error', checkResourceLoad);
    });

    // 监听样式表加载
    document.styleSheets.forEach(sheet => {
        checkResourceLoad();
    });
</script>
{{ end }}
